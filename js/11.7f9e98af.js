webpackJsonp([11],{619:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=a(627),r=n(u),c=a(634),s=n(c),d=a(300),f=n(d),p=a(99),m=n(p),h=a(100),y=n(h),v=a(42),C=n(v),g=a(56),k=n(g),E=a(660),b=n(E),T=a(652),S=n(T),L=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(628),a(635),a(299),a(101),a(102),a(43),a(57),a(662),a(653);var w=a(1),O=n(w),_=a(626),D=n(_),x=a(671),j=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(x);a(797);var I=S.default.RangePicker,N=function(e){function t(e){l(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={columns:[{title:"券名称",dataIndex:"title",key:"title"},{title:"到期时间",dataIndex:"validEndTime",key:"validEndTime"},{title:"券类型",dataIndex:"type",key:"type",render:function(e){return 1===e?"减免券":2==e?"折扣券":void 0}},{title:"面额",dataIndex:"balance",key:"balance"},{title:"适用条件",dataIndex:"enableAllCourse",key:"enableAllCourse",render:function(e){return 0===e?"部分课程":1==e?"全部课程":void 0}},{title:"组名",dataIndex:"label",key:"label"},{title:"已领取",dataIndex:"receiveCount",key:"receiveCount"},{title:"操作",key:"action",render:function(e,t,n){return O.default.createElement("span",null,O.default.createElement("a",{href:"javascript:;",onClick:function(){return a.editCoupon(e,t,n)}},"编辑"),O.default.createElement(b.default,{type:"vertical"}),O.default.createElement("a",{href:"javascript:;",onClick:function(){return a.copyLink(e,t,n)}},"复制链接"),O.default.createElement(b.default,{type:"vertical"}),O.default.createElement("a",{href:"javascript:;",onClick:function(){return a.deleteCoupon(e,t,n)}},"删除"))}}],couponList:[],dateData:[],orderSelect:"请选择",orderTypeSelect:"请选择",totalCount:0,page:0,limit:10,loading:!0,couponUrl:"",couponTitle:"",typeName:"",startTime:"",endTime:"",deleteData:{},deleteVisible:!1},a}return i(t,e),L(t,[{key:"componentDidMount",value:function(){this._getCouponList()}},{key:"createCoupon",value:function(){var e={pathname:"/addCoupon",state:{source:"coupon"}};this.props.history.push(e)}},{key:"editCoupon",value:function(e){var t={pathname:"/editCoupon",state:{source:"coupon",couponId:e.couponId}};this.props.history.push(t)}},{key:"deleteCoupon",value:function(e){this.setState({deleteVisible:!0,deleteData:e})}},{key:"cancelDelete",value:function(){this.setState({deleteVisible:!1})}},{key:"sureDeleteCoupon",value:function(){this.setState({deleteVisible:!1})}},{key:"copyLink",value:function(e){var t=document.getElementById("copy");t.value=e.linkCode,t.select(),document.execCommand("copy")&&k.default.success("复制成功")}},{key:"_getCouponList",value:function(){var e=this,t={page:0,limit:10};j.getCouponList(t).then(function(t){e.setState({couponList:t.data.list,totalCount:t.data.totalCount,loading:!1})})}},{key:"couponTitleChangeValue",value:function(e){this.setState({couponTitle:e.target.value})}},{key:"typeNameChangeValue",value:function(e){this.setState({typeName:e.target.value})}},{key:"onDateChange",value:function(e,t){this.setState({startTime:t[0],endTime:t[1]})}},{key:"onOk",value:function(e){}},{key:"searchCouponList",value:function(){var e=this,t={title:this.state.couponTitle,label:this.state.typeName,startTime:this.state.startTime,endTime:this.state.endTime,limit:10,page:0};this.setState({loading:!0}),j.getCouponList(t).then(function(t){e.setState({couponList:t.data.list,totalCount:t.data.totalCount,loading:!1})})}},{key:"resetOrderList",value:function(){var e=this;this.setState({loading:!0}),j.getOrderList({}).then(function(t){e.setState({orderList:t.data.pages.list,orderTotal:t.data.totalMoney,totalCount:t.data.pages.totalCount,loading:!1,couponTitle:"",typeName:"",dateData:[],orderSelect:"请选择",orderTypeSelect:"请选择"})})}},{key:"pageChange",value:function(e){var t=this;this.setState({page:e,loading:!0},function(){var e={title:t.state.couponTitle,label:t.state.typeName,startTime:t.state.startTime,endTime:t.state.endTime,limit:10,page:t.state.page};j.getCouponList(e).then(function(e){t.setState({couponList:e.data.list,totalCount:e.data.totalCount,loading:!1})})})}},{key:"render",value:function(){var e=this;return O.default.createElement("div",null,O.default.createElement(D.default,{title:"优惠券管理"}),O.default.createElement("div",{className:"orderList-wrap"},O.default.createElement("input",{type:"text",id:"copy",style:{opacity:0}}),O.default.createElement(m.default,null,O.default.createElement(y.default,{span:3},O.default.createElement(C.default,{type:"primary",onClick:function(t){return e.createCoupon(t)}},"新建优惠券"))),O.default.createElement(m.default,{style:{marginTop:25}},O.default.createElement(y.default,{span:5},O.default.createElement("span",null," 券名称："),O.default.createElement(f.default,{style:{width:"140px"},placeholder:"请输入券名称",value:this.state.couponTitle,onChange:function(t){return e.couponTitleChangeValue(t)}})),O.default.createElement(y.default,{span:6},O.default.createElement("span",null," 组别名称："),O.default.createElement(f.default,{style:{width:"150px"},placeholder:"请输入组别名称",value:this.state.typeName,onChange:function(t){return e.typeNameChangeValue(t)}})),O.default.createElement(y.default,{span:11},O.default.createElement("span",{style:{marginRight:6}},"订单时间:"),O.default.createElement(I,{style:{width:390},onChange:function(t,a){return e.onDateChange(t,a)},onOk:function(t){return e.onOk(t)},showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",placeholder:["开始时间","结束时间"]})),O.default.createElement(y.default,{span:2},O.default.createElement(C.default,{type:"primary",onClick:function(){e.searchCouponList()}},"查询"))),O.default.createElement(m.default,{style:{marginTop:25}},O.default.createElement(s.default,{columns:this.state.columns,rowKey:function(e,t){return t},dataSource:this.state.couponList,loading:this.state.loading,pagination:{defaultPageSize:this.state.limit,current:this.state.page,total:this.state.totalCount,onChange:this.pageChange.bind(this)}}))),O.default.createElement(r.default,{title:"删除优惠券",visible:this.state.deleteVisible,onCancel:this.cancelDelete.bind(this),footer:[O.default.createElement(C.default,{key:"back",onClick:function(){return e.cancelDelete()}},"取消"),O.default.createElement(C.default,{key:"submit",type:"primary",onClick:function(){return e.sureDeleteCoupon()}},"确定")]},O.default.createElement("p",null,"确定要删除",O.default.createElement("strong",null,"《",this.state.deleteData.title,"》"),"这个优惠券吗？")))}}]),t}(O.default.Component);t.default=N}});