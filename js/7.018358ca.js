webpackJsonp([7],{1113:function(e,t){},618:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=a(627),i=n(r),c=a(634),u=n(c),d=a(42),f=n(d),h=a(99),p=n(h),m=a(100),y=n(m),C=a(56),b=n(C),v=a(308),g=n(v),E=a(300),S=n(E),I=a(629),k=n(I),w=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(628),a(635),a(43),a(101),a(102),a(57),a(309),a(299),a(631);var T=a(1),O=n(T),x=(a(37),a(790)),N=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(x);n(a(626)),a(1113);var _=k.default.Option,L=[{title:"排序",dataIndex:"showOrder",key:"showOrder"},{title:"内容名称",dataIndex:"contentTitle",key:"contentTitle"},{title:"类型",dataIndex:"contentType",key:"contentType",render:function(e,t){return"AUDIO"==t.contentType?"音频":"VIDEO"==t.contentType?"视频":""}},{title:"上架时间",dataIndex:"publishTime",key:"publishTime"},{title:"状态",dataIndex:"contentState",key:"contentState",render:function(e,t){return"release"==t.contentState?"已上架":"已下架"}},{title:"操作",key:"action",render:function(e,t){return O.default.createElement("span",{style:{display:"flex",width:"160px"}},O.default.createElement(g.default,{trigger:"click",style:{background:"white"},title:O.default.createElement("div",{className:"sort_number_box",style:{width:"200px",display:"flex",alignItems:"center"}},O.default.createElement("span",null,"移动到第"),O.default.createElement(S.default.Search,{enterButton:!1,onSearch:function(e){return M.onSearch(e)},placeholder:"输入排序",style:{width:"100px",display:"flex"}}),O.default.createElement("span",null,"位"))},O.default.createElement("a",{style:{flex:1},href:"javascript:;",onClick:function(){return M.sortTable(t)}},"排序")),O.default.createElement("a",{style:{flex:1},href:"javascript:;",onClick:function(){return M.showModal(t)}},"release"==t.contentState?"下架":"上架"),O.default.createElement("a",{style:{flex:1},rel:"noopener noreferrer",href:"javascript:;",onClick:function(){return M.editCourseContent(t)}},"编辑"),O.default.createElement("a",{style:{flex:1},rel:"noopener noreferrer",href:"javascript:;",onClick:function(){return M.doDelete(t)}},"删除"))}}],M=function(e){function t(e){s(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={courseId:"",courseInfo:{},classList:[],infoMsg:"",loading:!1,visible:!1,sortNumber:"",sortNumberVisible:!1,courseContentId:"",toolTipVisible:!1,title:"",record:"",deleteVisible:!1,contentState:"",contentType:"",page:1,pageSize:10,total:""},t.sortTable=a.sortTable.bind(a),t.showModal=a.showModal.bind(a),t.onSearch=a.onSearch.bind(a),t.editCourseContent=a.editCourseContent.bind(a),t.doDelete=a.doDelete.bind(a),a}return o(t,e),w(t,[{key:"componentWillMount",value:function(){this.state.courseId=this.props.location.state.record.courseId,this.getCourseInfo(),this.searchCourse()}},{key:"onSearch",value:function(e){var t=this;if(/^[+-]?\d*\.?\d{0,3}$/.test(e))if(e>=-1e4&&e<=1e4){var a={courseContentId:this.state.record.courseContentId,showOrder:Number(e)};N.actionCourseContent(a).then(function(e){200===e.code?(t.searchCourse(),b.default.success(e.msg),t.setState({toolTipVisible:!1})):b.default.error(e.msg)})}else b.default.warn("请输入正负1万，小数点最多3位的数字");else b.default.warn("请输入正负1万，小数点最多3位的数字")}},{key:"sortTable",value:function(e){this.setState({record:e})}},{key:"editCourseContent",value:function(e){var t={rootId:this.state.courseInfo.courseId,classListLength:this.state.classList.length,contentType:this.state.classList.length>0&&this.state.classList[0].contentType,courseContentId:e.courseContentId,record:e},a={pathname:"/addClass",state:t};this.props.history.push(a)}},{key:"doDelete",value:function(e){this.setState({record:e,infoMsg:"是否对"+e.contentTitle+"课时删除操作？",deleteVisible:!0})}},{key:"handleDeleteCancel",value:function(){this.setState({deleteVisible:!1})}},{key:"handleDeleteOk",value:function(){var e=this;N.deleteCourseContent([this.state.record.courseContentId]).then(function(t){200===t.code?(e.searchCourse(),b.default.success(t.msg||"删除成功"),e.setState({deleteVisible:!1})):b.default.error(t.msg||"删除失败")}).catch(function(e){})}},{key:"getCourseInfo",value:function(){var e=this,t={courseId:this.props.location.state.record.courseId};this.setState({loading:!0}),N.getCourseInfo(t).then(function(t){200===t.code?(t.data.contentList.forEach(function(e,t){e.index=t,e.contentState=null==e.contentState?"release":e.contentState}),e.setState({courseInfo:t.data,loading:!1})):b.default.destroy()}).catch(function(e){})}},{key:"showModal",value:function(e){"release"===e.contentState?this.setState({infoMsg:"是否对"+e.contentTitle+"课时下架操作？"}):this.setState({infoMsg:"是否对"+e.contentTitle+"课时上架操作？"}),this.setState({visible:!0,record:e})}},{key:"handleOk",value:function(){var e=this,t={contentState:"release"===this.state.record.contentState?"unrelease":"release",courseContentId:this.state.record.courseContentId};N.actionCourseContent(t).then(function(t){200===t.code?(e.searchCourse(),b.default.success(t.msg),e.setState({visible:!1})):b.default.error(t.msg)})}},{key:"addClass",value:function(){var e={rootId:this.state.courseInfo.courseId,classListLength:this.state.classList.length<=0||this.state.classList.length,contentType:this.state.classList.length>0?this.state.classList[0].contentType:"",isAddClass:!0},t={pathname:"/addClass",state:e};this.props.history.push(t)}},{key:"handleCancel",value:function(){this.setState({visible:!1})}},{key:"statusChange",value:function(e){this.setState({contentState:e})}},{key:"typeChange",value:function(e){this.setState({contentType:e})}},{key:"onPageChange",value:function(e){var t=this;this.setState({page:e},function(){t.searchCourse()})}},{key:"searchCourse",value:function(){var e=this,t={page:this.state.page-1,limit:this.state.pageSize,rootId:this.state.courseId,contentType:this.state.contentType,contentState:this.state.contentState};N.getCourseInfoList(t).then(function(t){200===t.code&&(t.data.list.forEach(function(e,t){e.index=t,e.contentState=null==e.contentState?"release":e.contentState}),e.setState({total:t.data.totalCount,classList:t.data.list,loading:!1}))}).catch(function(e){})}},{key:"render",value:function(){var e=this;return O.default.createElement("div",null,O.default.createElement(p.default,{className:"class-wrapper class-head"},O.default.createElement(y.default,{span:24},O.default.createElement("h2",null,"课程信息："),O.default.createElement("div",{className:"courseInfo-wrap"},O.default.createElement("div",{className:"courseInfo"},O.default.createElement("img",{src:this.state.courseInfo.themePicUrl,alt:"",className:"course-img"}),O.default.createElement("div",{className:"courseinfo-box"},O.default.createElement("h4",null,this.state.courseInfo.courseTitle),O.default.createElement("p",{className:"course-text"},this.state.courseInfo.description),O.default.createElement("p",{className:"buy-quantity"},"购买数量：",this.state.courseInfo.salesCounts||0)))))),O.default.createElement(p.default,{className:"class-wrapper class-body"},O.default.createElement(y.default,{span:10},O.default.createElement(f.default,{type:"primary",className:"add-newCourse",onClick:function(){return e.addClass()}},"添加内容")),O.default.createElement(y.default,{span:14,className:"header-right"},O.default.createElement("span",{className:"title"},"内容状态"),O.default.createElement(k.default,{defaultValue:"",placeholder:"请选择状态",style:{width:120},onChange:this.statusChange.bind(this)},O.default.createElement(_,{value:""},"全部"),O.default.createElement(_,{value:"release"},"已上架"),O.default.createElement(_,{value:"unrelease"},"已下架")),O.default.createElement("span",{className:"title"},"内容类型"),O.default.createElement(k.default,{defaultValue:"",placeholder:"请选择类型",style:{width:120},onChange:this.typeChange.bind(this)},O.default.createElement(_,{value:""},"全部"),O.default.createElement(_,{value:"AUDIO"},"音频"),O.default.createElement(_,{value:"VIDEO"},"视频")),O.default.createElement(f.default,{type:"primary",onClick:function(t){return e.searchCourse(t)},className:"query-btn"},"查询")),O.default.createElement(y.default,{span:24},O.default.createElement("div",{className:"class-list"},O.default.createElement(u.default,{rowKey:function(e){return e.index},columns:L,dataSource:this.state.classList,loading:this.state.loading,pagination:{defaultPageSize:10,current:this.state.page,total:this.state.total,onChange:this.onPageChange.bind(this)}})))),O.default.createElement(i.default,{title:this.state.title,visible:this.state.visible,onCancel:function(){return e.handleCancel()},onOk:function(){return e.handleOk()}},O.default.createElement("p",null,this.state.infoMsg)),O.default.createElement(i.default,{title:"排序",visible:this.state.sortNumberVisible,className:"sort_number_visible"}),O.default.createElement(i.default,{title:"",visible:this.state.deleteVisible,onCancel:function(){return e.handleDeleteCancel()},onOk:function(){return e.handleDeleteOk()}},O.default.createElement("p",null,this.state.infoMsg)))}}]),t}(O.default.Component);t.default=M}});